process ProdTPGParam  = {

# Calo geometry service model
   include "Geometry/CaloEventSetup/data/CaloGeometry.cfi"
   include "Geometry/CaloEventSetup/data/EcalTrigTowerConstituents.cfi"
   include "Geometry/CMSCommonData/data/cmsIdealGeometryXML.cfi"

# ecal mapping
   include "Geometry/EcalMapping/data/EcalMapping.cfi"
   es_source eegeom = EmptyESSource {
     string recordName = "EcalMappingRcd"
     vuint32 firstValid = { 1 }
     bool iovIsRunNotTime = true
   }

# Get hardcoded conditions the same used for standard digitization
   include "CalibCalorimetry/EcalTrivialCondModules/data/EcalTrivialCondRetriever.cfi"



#########################
 source = EmptySource {}
 untracked PSet maxEvents = {untracked int32 input = 1}

 module TPGParamProducer = EcalTPGParamBuilder {

  #### inputs/ouputs control ####
  bool readFromDB   = false

  bool writeToDB = false
  string DBsid   = "ecalh4db"
  string DBuser  = "test09"
  string DBpass  = "oratest09"
  uint32 DBport  = 1521
  uint32 DBfirstRun = 27400
  uint32 DBnbRun    = 28000

  bool writeToFiles = true
  string outFile = "TPG_startup.txt"


  #### TPG calculation parameters ####

  bool   useTransverseEnergy = false # true when TPG computes transverse energy, false for energy
  double Et_sat_EB = 35.84           # Saturation value (in GeV) of the TPG before the compressed-LUT (rem: with 35.84 the TPG_LSB = crystal_LSB in EB)
  double Et_sat_EE = 35.84           # Saturation value (in GeV) of the TPG before the compressed-LUT

  uint32 sliding = 0                 # Parameter used for the FE data format, should'nt be changed

  uint32 weight_sampleMax = 3        # position of the maximum among the 5 samples used by the TPG amplitude filter 

  string LUT_option = "Identity"     # compressed LUT option can be: "Identity", "Linear", "EcalResolution"
  double LUT_threshold_EB = 0.210    # All Trigger Primitives <= threshold (in GeV) will be set to 0 
  double LUT_threshold_EE = 0.210    # All Trigger Primitives <= threshold (in GeV) will be set to 0 
  double LUT_stochastic_EB = 0.03    # Stochastic term of the ECAL-EB ET resolution (used only if LUT_option="EcalResolution")
  double LUT_noise_EB = 0.200        # noise term (GeV) of the ECAL-EB ET resolution (used only if LUT_option="EcalResolution")
  double LUT_constant_EB = 0.005     # constant term of the ECAL-EB ET resolution (used only if LUT_option="EcalResolution")
  double LUT_stochastic_EE = 0.03    # Stochastic term of the ECAL-EE ET resolution (used only if LUT_option="EcalResolution")
  double LUT_noise_EE = 0.200        # noise term (GeV) of the ECAL-EE ET resolution (used only if LUT_option="EcalResolution")
  double LUT_constant_EE = 0.005     # constant term of the ECAL-EE ET resolution (used only if LUT_option="EcalResolution")

  double TTF_lowThreshold_EB = 0.210   # EB Trigger Tower Flag low threshold in GeV
  double TTF_highThreshold_EB = 0.210  # EB Trigger Tower Flag high threshold in GeV
  double TTF_lowThreshold_EE = 0.210   # EE Trigger Tower Flag low threshold in GeV
  double TTF_highThreshold_EE = 0.210  # EE Trigger Tower Flag high threshold in GeV

  double FG_lowThreshold_EB = 0.210    # EB Fine Grain Et low threshold in GeV
  double FG_highThreshold_EB = 0.210   # EB Fine Grain Et high threshold in GeV
  double FG_lowRatio_EB = 0.80       # EB Fine Grain low-ratio
  double FG_highRatio_EB = 0.80      # EB Fine Grain high-ratio
  uint32 FG_lut_EB = 0               # EB Fine Grain Look-up table. Put something != 0 if you really know what you do!
  double FG_Threshold_EE = 0.        # EE Fine threshold in GeV
  uint32 FG_lut_strip_EE = 0         # EE Fine Grain strip Look-up table
  uint32 FG_lut_tower_EE = 0         # EE Fine Grain tower Look-up table
 }
 
 path p = { TPGParamProducer }

}
